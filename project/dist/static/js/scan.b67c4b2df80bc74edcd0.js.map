{"version":3,"sources":["webpack:///src/pages/scan/Scan.vue","webpack:///./src/pages/scan/Scan.vue?f731","webpack:///./src/pages/scan/Scan.vue","webpack:///./src/pages/scan/scan.js","webpack:///./src/axios/index.js","webpack:///./src/utils/wxJsApiSdk.js"],"names":["Scan","name","components","data","config","latitude","longitude","enterRange","locationSuccess","result","mounted","this","getLocation","methods","_this","$axios","method","url","location","href","split","then","res","console","log","$handleGetLocation","warn","lat","lng","catch","err","error","wxScanCode","_this2","$handleScanQR","str","scan_Scan","render","_vm","_h","$createElement","_c","_self","staticStyle","padding","staticClass","_v","float","margin-right","attrs","plain","size","type","icon","on","click","$event","title","scopedSlots","_u","key","fn","_s","proxy","_e","margin","round","block","loading","loading-text","staticRenderFns","pages_scan_Scan","__webpack_require__","normalizeComponent","ssrContext","Vue","prototype","wx","handleGetLocation","handleScanQR","use","vueCookies","Vant","h","axios","$mount","__WEBPACK_IMPORTED_MODULE_0_vue__","__WEBPACK_IMPORTED_MODULE_1_axios__","__WEBPACK_IMPORTED_MODULE_1_axios___default","n","__webpack_exports__","wxconfigInfo","debug","appId","timestamp","parseInt","nonceStr","signature","jsApiList","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_promise___default","a","resolve","reject","ready","success","speed","accuracy","fail","checkJsApi","checkResult","scanQRCode","desc","needResult","scanType","resultStr","alert"],"mappings":"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","file":"static/js/scan.b67c4b2df80bc74edcd0.js","sourcesContent":["<template>\n  <!-- begin:: Page -->\n  <div>\n    <div style=\"padding:10px 0\">\n      <span class=\"title\">定位信息</span>\n      <van-button\n        plain\n        size=\"mini\"\n        type=\"info\"\n        style=\"float:right;margin-right:10px\"\n        icon=\"location-o\"\n        @click=\"getLocation()\"\n      >重新定位</van-button>\n    </div>\n    <van-cell-group>\n      <van-cell title=\"经度\">\n        <template #default>\n          <span>{{ latitude }}</span>\n        </template>\n      </van-cell>\n      <van-cell title=\"纬度\">\n        <template #default>\n          <span>{{ longitude }}</span>\n        </template>\n      </van-cell>\n      <van-cell v-if=\"showErr\" title=\"错误\">\n        <template #default>\n          <span>{{ err }}</span>\n        </template>\n      </van-cell>\n    </van-cell-group>\n    <!-- 检测定位状态 确定是否可扫码签到 -->\n    <div style=\"margin: 16px;\">\n      <van-button round block type=\"info\" \n        :loading=\"!enterRange\"\n        loading-text=\"定位中...\"\n        @click=\"wxScanCode()\">扫码签到</van-button>\n    </div>\n    <van-cell-group>\n      <van-cell title=\"扫码结果\">\n        <template #default>\n          <span>{{ result }}</span>\n        </template>\n      </van-cell>\n    </van-cell-group>\n  </div>\n</template>\n\n<script>\n//  import wx from 'weixin-js-sdk'; //这个是坑\nimport wx from \"weixin-jsapi\"; //es6版本的js-sdk\nexport default {\n  name: \"Scan\",\n  components: {},\n  data() {\n    return {\n      config: null,\n      latitude: \"\",\n      longitude: \"\",\n      enterRange: false, // 判断是否进入签到范围\n      locationSuccess: false, // 判断是否定位成功\n      result: \"\" // 扫码结果\n    };\n  },\n  mounted() {\n    this.getLocation()\n  },\n  methods: {\n    getLocation() {\n      this.locationSuccess = false;\n      this.enterRange = false;\n      this.latitude = ''\n      this.longitude = ''\n      // 获取位置信息后请求后台接口\n      this.$axios({\n        method: \"post\",\n        url:\"/proxy/raptorCustomerServer/service/weChatPublicNumber/test/getTicketSignature.do\",\n        data: { url: location.href.split(\"#\")[0] } //向服务端提供授权url参数，并且不需要#后面的部分\n      })\n      .then(res => {\n        if (res) {\n          let config = res.data.data;\n          console.log(config);\n          // 存储config 同一个url仅需调用一次\n          this.config = config;\n          this.$handleGetLocation(config)\n            .then(res => {\n              console.warn(\"首页获取位置成功\", res);\n              this.latitude = res.lat;\n              this.longitude = res.lng;\n              this.locationSuccess = true\n              // 这里根据获取到的经纬度请求后台接口...\n              // TODO 判断范围是否正确\n              this.enterRange = true;\n            })\n            .catch(err => {\n              console.error(\"获取定位失败\", err);\n            });\n        }\n      })\n      .catch(err => {\n        console.error(\"获取定位失败\", err);\n      });\n    },\n    wxScanCode() {\n      this.$handleScanQR(this.config)\n        .then(res => {\n          this.result = res.str;\n        })\n        .catch(err => {\n          console.error(\"扫描二维码失败\", err);\n        });\n      // this.$axios({\n      //   method: \"post\",\n      //   url:\n      //     \"/proxy/raptorCustomerServer/service/weChatPublicNumber/test/getTicketSignature.do\",\n      //   data: { url: location.href.split(\"#\")[0] } //向服务端提供授权url参数，并且不需要#后面的部分\n      // }).then(res => {\n      //   let config = res.data.data;\n      //   console.log(config);\n      //   wx.config({\n      //     debug: false, // 开启调试模式,\n      //     appId: config.appId, // 必填，企业号的唯一标识，此处填写企业号corpid\n      //     timestamp: config.timestamp, // 必填，生成签名的时间戳\n      //     nonceStr: config.nonceStr, // 必填，生成签名的随机串\n      //     signature: config.signature, // 必填，签名，见附录1\n      //     jsApiList: [\"scanQRCode\"] // 必填，需要使用的JS接口列表，所有JS接口列表见附录2\n      //   });\n\n      //   wx.ready(function() {\n      //     // config信息验证成功后会执行ready方法,所有接口调用都必须在config接口获得结果之后\n      //     // config 是一个客户端的异步操作,所以如果需要在页面加载时调用相关接口,则须把相关接口放在ready函数中调用来确保正确执行.对于用户触发是才调用的接口,则可以直接调用,不需要放在ready函数中\n      //     wx.checkJsApi({\n      //       // 判断当前客户端版本是否支持指定JS接口\n      //       jsApiList: [\"scanQRCode\"],\n      //       success: function(res) {\n      //         // 以键值对的形式返回，可用true，不可用false。如：{\"checkResult\":{\"scanQRCode\":true},\"errMsg\":\"checkJsApi:ok\"}\n      //         if (res.checkResult.scanQRCode === true) {\n      //           wx.scanQRCode({\n      //             // 微信扫一扫接口\n      //             desc: \"scanQRCode desc\",\n      //             needResult: 0, // 默认为0，扫描结果由微信处理，1则直接返回扫描结果，\n      //             scanType: [\"qrCode\", \"barCode\"], // 可以指定扫二维码还是一维码，默认二者都有\n      //             success: function(res) {\n      //               var result = res.resultStr; // 当needResult 为 1 时，扫码返回的结果\n      //               // location.href=res.resultStr;//扫描结果传递到的处理页面,跳转到这个页面\n      //               this.data.result = res;\n      //               // location.href=res.resultStr;//扫描结果传递到的处理页面,跳转到这个页面\n      //               // sessionStorage.setItem('saomiao_result',result);\n      //               //其它网页调用二维码扫描结果：\n      //               // var result = sessionStorage.getItem(\"saomiao_result\");\n      //             }\n      //           });\n      //         } else {\n      //           alert(\"抱歉，当前客户端版本不支持扫一扫\");\n      //         }\n      //       },\n      //       fail: function(res) {\n      //         // 检测getNetworkType该功能失败时处理\n      //         alert(\"fail\" + res);\n      //       }\n      //     });\n      //   });\n\n      //   /* 处理失败验证 */\n      //   wx.error(function(res) {\n      //     // config 信息验证失败会执行error函数,如签名过期导致验证失败,具体错误信息可以打开config的debug模式查看,也可以在返回的res参数中查看,对于SPA可以在这里更新签名\n      //     alert(\"配置验证失败: \" + res.errMsg);\n      //   });\n      // });\n    }\n  }\n};\n</script>\n<style scoped>\nh2,\n.title {\n  margin: 0;\n  text-align: left;\n  padding: 20px 16px 16px;\n  color: rgba(69, 90, 100, 0.6);\n  font-weight: normal;\n  font-size: 14px;\n  line-height: 16px;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/pages/scan/Scan.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticStyle:{\"padding\":\"10px 0\"}},[_c('span',{staticClass:\"title\"},[_vm._v(\"定位信息\")]),_vm._v(\" \"),_c('van-button',{staticStyle:{\"float\":\"right\",\"margin-right\":\"10px\"},attrs:{\"plain\":\"\",\"size\":\"mini\",\"type\":\"info\",\"icon\":\"location-o\"},on:{\"click\":function($event){return _vm.getLocation()}}},[_vm._v(\"重新定位\")])],1),_vm._v(\" \"),_c('van-cell-group',[_c('van-cell',{attrs:{\"title\":\"经度\"},scopedSlots:_vm._u([{key:\"default\",fn:function(){return [_c('span',[_vm._v(_vm._s(_vm.latitude))])]},proxy:true}])}),_vm._v(\" \"),_c('van-cell',{attrs:{\"title\":\"纬度\"},scopedSlots:_vm._u([{key:\"default\",fn:function(){return [_c('span',[_vm._v(_vm._s(_vm.longitude))])]},proxy:true}])}),_vm._v(\" \"),(_vm.showErr)?_c('van-cell',{attrs:{\"title\":\"错误\"},scopedSlots:_vm._u([{key:\"default\",fn:function(){return [_c('span',[_vm._v(_vm._s(_vm.err))])]},proxy:true}],null,false,4277965029)}):_vm._e()],1),_vm._v(\" \"),_c('div',{staticStyle:{\"margin\":\"16px\"}},[_c('van-button',{attrs:{\"round\":\"\",\"block\":\"\",\"type\":\"info\",\"loading\":!_vm.enterRange,\"loading-text\":\"定位中...\"},on:{\"click\":function($event){return _vm.wxScanCode()}}},[_vm._v(\"扫码签到\")])],1),_vm._v(\" \"),_c('van-cell-group',[_c('van-cell',{attrs:{\"title\":\"扫码结果\"},scopedSlots:_vm._u([{key:\"default\",fn:function(){return [_c('span',[_vm._v(_vm._s(_vm.result))])]},proxy:true}])})],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-6853ad14\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/scan/Scan.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-6853ad14\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Scan.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Scan.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Scan.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-6853ad14\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./Scan.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-6853ad14\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/scan/Scan.vue\n// module id = null\n// module chunks = ","import Vue from 'vue'\nimport axios from '@/axios';\nimport Vant from 'vant';\nimport 'vant/lib/index.css';\nimport vueCookies from 'vue-cookies'\n// 在main.js中引入 weixin-jsapi\nimport wx from \"weixin-jsapi\"; \nimport {handleGetLocation, handleScanQR} from '@/utils/wxJsApiSdk'\n\nimport Scan from './Scan.vue'\n\n// 在main.js中注册 weixin-jsapi\nVue.prototype.wx = wx\n\nVue.prototype.$handleGetLocation = handleGetLocation\nVue.prototype.$handleScanQR = handleScanQR\n\nVue.use(vueCookies);\nVue.use(Vant);\n\nnew Vue({\n  render: h => h(Scan),\n\taxios\n}).$mount('#app')\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/scan/scan.js","/*引入Vue框架*/\r\nimport Vue from 'vue';\r\n/*引入资源请求插件*/\r\nimport axios from 'axios';\r\n\r\n/*使用axios插件*/\r\nVue.prototype.$axios = axios;\r\nexport default({\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/axios/index.js","import wx from \"weixin-jsapi\";\r\n\r\n/**\r\n * 注入权限验证配置\r\n * @param {object} 微信 js-sdk 权限验证配置\r\n */\r\nexport const wxconfigInfo = config => {\r\n  wx.config({\r\n    debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。\r\n    appId: config.appId,\r\n    timestamp: parseInt(config.timestamp),\r\n    nonceStr: config.nonceStr,\r\n    signature: config.signature,\r\n    jsApiList: [\r\n      // 需要使用的 jsapi 列表\r\n      \"scanQRCode\", // 扫描二维码\r\n      \"getLocation\" // 获取地理位置\r\n    ]\r\n  });\r\n};\r\n\r\n/**\r\n * 微信获取位置\r\n */\r\nexport const handleGetLocation = config => {\r\n  return new Promise((resolve, reject) => {\r\n    wxconfigInfo(config);\r\n    wx.ready(function() {\r\n      wx.getLocation({\r\n        type: \"wgs84\", // 默认为wgs84的gps坐标，如果要返回直接给openLocation用的火星坐标，可传入'gcj02'\r\n        success: function(res) {\r\n          console.warn(\"微信sdk定位成功\", res);\r\n          resolve({\r\n            lat: res.latitude, // 纬度\r\n            lng: res.longitude, // 经度\r\n            speed: res.speed, // 速度，以米/每秒计\r\n            accuracy: res.accuracy // 位置精度\r\n          });\r\n        },\r\n        fail: function(err) {\r\n          console.error(\"微信sdk定位失败\", err);\r\n          reject(err);\r\n        }\r\n      });\r\n    });\r\n    wx.error(function(err) {\r\n      // config信息验证失败会执行error函数，如签名过期导致验证失败，具体错误信息可以打开config的debug模式查看，也可以在返回的res参数中查看，对于SPA可以在这里更新签名。\r\n      console.log(\"wxjsapi-error=\", err);\r\n      reject(err);\r\n    });\r\n  });\r\n};\r\n\r\n/**\r\n * 微信扫一扫\r\n */\r\nexport const handleScanQR = config => {\r\n  return new Promise((resolve, reject) => {\r\n    wxconfigInfo(config);\r\n    wx.ready(function() {\r\n      // config信息验证成功后会执行ready方法,所有接口调用都必须在config接口获得结果之后\r\n      // config 是一个客户端的异步操作,所以如果需要在页面加载时调用相关接口,则须把相关接口放在ready函数中调用来确保正确执行.对于用户触发是才调用的接口,则可以直接调用,不需要放在ready函数中\r\n      wx.checkJsApi({\r\n        // 判断当前客户端版本是否支持指定JS接口\r\n        jsApiList: [\"scanQRCode\"],\r\n        success: function(res) {\r\n          // 以键值对的形式返回，可用true，不可用false。如：{\"checkResult\":{\"scanQRCode\":true},\"errMsg\":\"checkJsApi:ok\"}\r\n          if (res.checkResult.scanQRCode === true) {\r\n            wx.scanQRCode({\r\n              // 微信扫一扫接口\r\n              desc: \"scanQRCode desc\",\r\n              needResult: 1, // 默认为0，扫描结果由微信处理，1则直接返回扫描结果，\r\n              scanType: [\"qrCode\", \"barCode\"], // 可以指定扫二维码还是一维码，默认二者都有\r\n              success: function(res) {\r\n                console.warn(\"微信sdk定位成功\", res);\r\n                resolve({\r\n                  str: res.resultStr //  当needResult 为 1 时，扫码返回的结果\r\n                });\r\n                var result = res.resultStr; // 当needResult 为 1 时，扫码返回的结果\r\n                // location.href=res.resultStr;//扫描结果传递到的处理页面,跳转到这个页面\r\n                // location.href=res.resultStr;//扫描结果传递到的处理页面,跳转到这个页面\r\n                // sessionStorage.setItem('saomiao_result',result);\r\n                //其它网页调用二维码扫描结果：\r\n                // var result = sessionStorage.getItem(\"saomiao_result\");\r\n              }\r\n            });\r\n          } else {\r\n            alert(\"抱歉，当前客户端版本不支持扫一扫\");\r\n          }\r\n        },\r\n        fail: function(err) {\r\n          console.error(\"调用微信扫一扫失败\", err);\r\n          reject(err);\r\n        }\r\n      });\r\n    });\r\n    wx.error(function(err) {\r\n      // config信息验证失败会执行error函数，如签名过期导致验证失败，具体错误信息可以打开config的debug模式查看，也可以在返回的res参数中查看，对于SPA可以在这里更新签名。\r\n      console.log(\"wxjsapi-error=\", err);\r\n      reject(err);\r\n    });\r\n  });\r\n}\r\n\r\nexport default {handleGetLocation, handleScanQR}\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/wxJsApiSdk.js"],"sourceRoot":""}