{"version":3,"sources":["webpack:///./src/axios/index.js","webpack:///./src/utils/wxJsApiSdk.js","webpack:///src/pages/readImg/Scanqr.vue","webpack:///./src/pages/readImg/Scanqr.vue?2847","webpack:///./src/pages/readImg/Scanqr.vue","webpack:///./src/pages/readImg/scanqr.js"],"names":["__WEBPACK_IMPORTED_MODULE_0_vue__","__webpack_require__","__WEBPACK_IMPORTED_MODULE_1_axios__","__WEBPACK_IMPORTED_MODULE_1_axios___default","n","Vue","prototype","$axios","axios","__webpack_exports__","wxconfigInfo","config","wx","debug","appId","timestamp","parseInt","nonceStr","signature","jsApiList","handleGetLocation","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_promise___default","a","resolve","reject","ready","getLocation","type","success","res","console","warn","lat","latitude","lng","longitude","speed","accuracy","fail","err","error","log","handleScanQR","checkJsApi","checkResult","scanQRCode","desc","needResult","scanType","str","resultStr","alert","Scanqr","name","components","data","loading","result","mounted","this","getConfig","methods","_this","method","url","location","href","split","then","catch","wxScanCode","_this2","$handleScanQR","readImg_Scanqr","render","_vm","_h","$createElement","_c","_self","staticStyle","margin","attrs","round","block","loading-text","on","click","$event","_v","title","scopedSlots","_u","key","fn","_s","proxy","staticRenderFns","pages_readImg_Scanqr","normalizeComponent","ssrContext","$handleGetLocation","use","vueCookies","Vant","h","$mount"],"mappings":"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","file":"static/js/scanqr.876f37f6c2fb3d0c5dd1.js","sourcesContent":["/*引入Vue框架*/\r\nimport Vue from 'vue';\r\n/*引入资源请求插件*/\r\nimport axios from 'axios';\r\n\r\n/*使用axios插件*/\r\nVue.prototype.$axios = axios;\r\nexport default({\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/axios/index.js","import wx from \"weixin-jsapi\";\r\n\r\n/**\r\n * 注入权限验证配置\r\n * @param {object} 微信 js-sdk 权限验证配置\r\n */\r\nexport const wxconfigInfo = config => {\r\n  wx.config({\r\n    debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。\r\n    appId: config.appId,\r\n    timestamp: parseInt(config.timestamp),\r\n    nonceStr: config.nonceStr,\r\n    signature: config.signature,\r\n    jsApiList: [\r\n      // 需要使用的 jsapi 列表\r\n      \"scanQRCode\", // 扫描二维码\r\n      \"getLocation\" // 获取地理位置\r\n    ]\r\n  });\r\n};\r\n\r\n/**\r\n * 微信获取位置\r\n */\r\nexport const handleGetLocation = config => {\r\n  return new Promise((resolve, reject) => {\r\n    wxconfigInfo(config);\r\n    wx.ready(function() {\r\n      wx.getLocation({\r\n        type: \"wgs84\", // 默认为wgs84的gps坐标，如果要返回直接给openLocation用的火星坐标，可传入'gcj02'\r\n        success: function(res) {\r\n          console.warn(\"微信sdk定位成功\", res);\r\n          resolve({\r\n            lat: res.latitude, // 纬度\r\n            lng: res.longitude, // 经度\r\n            speed: res.speed, // 速度，以米/每秒计\r\n            accuracy: res.accuracy // 位置精度\r\n          });\r\n        },\r\n        fail: function(err) {\r\n          console.error(\"微信sdk定位失败\", err);\r\n          reject(err);\r\n        }\r\n      });\r\n    });\r\n    wx.error(function(err) {\r\n      // config信息验证失败会执行error函数，如签名过期导致验证失败，具体错误信息可以打开config的debug模式查看，也可以在返回的res参数中查看，对于SPA可以在这里更新签名。\r\n      console.log(\"wxjsapi-error=\", err);\r\n      reject(err);\r\n    });\r\n  });\r\n};\r\n\r\n/**\r\n * 微信扫一扫\r\n */\r\nexport const handleScanQR = config => {\r\n  return new Promise((resolve, reject) => {\r\n    wxconfigInfo(config);\r\n    wx.ready(function() {\r\n      // config信息验证成功后会执行ready方法,所有接口调用都必须在config接口获得结果之后\r\n      // config 是一个客户端的异步操作,所以如果需要在页面加载时调用相关接口,则须把相关接口放在ready函数中调用来确保正确执行.对于用户触发是才调用的接口,则可以直接调用,不需要放在ready函数中\r\n      wx.checkJsApi({\r\n        // 判断当前客户端版本是否支持指定JS接口\r\n        jsApiList: [\"scanQRCode\"],\r\n        success: function(res) {\r\n          // 以键值对的形式返回，可用true，不可用false。如：{\"checkResult\":{\"scanQRCode\":true},\"errMsg\":\"checkJsApi:ok\"}\r\n          if (res.checkResult.scanQRCode === true) {\r\n            wx.scanQRCode({\r\n              // 微信扫一扫接口\r\n              desc: \"scanQRCode desc\",\r\n              needResult: 1, // 默认为0，扫描结果由微信处理，1则直接返回扫描结果，\r\n              scanType: [\"qrCode\", \"barCode\"], // 可以指定扫二维码还是一维码，默认二者都有\r\n              success: function(res) {\r\n                console.warn(\"微信sdk定位成功\", res);\r\n                resolve({\r\n                  str: res.resultStr //  当needResult 为 1 时，扫码返回的结果\r\n                });\r\n                var result = res.resultStr; // 当needResult 为 1 时，扫码返回的结果\r\n                // location.href=res.resultStr;//扫描结果传递到的处理页面,跳转到这个页面\r\n                // location.href=res.resultStr;//扫描结果传递到的处理页面,跳转到这个页面\r\n                // sessionStorage.setItem('saomiao_result',result);\r\n                //其它网页调用二维码扫描结果：\r\n                // var result = sessionStorage.getItem(\"saomiao_result\");\r\n              }\r\n            });\r\n          } else {\r\n            alert(\"抱歉，当前客户端版本不支持扫一扫\");\r\n          }\r\n        },\r\n        fail: function(err) {\r\n          console.error(\"调用微信扫一扫失败\", err);\r\n          reject(err);\r\n        }\r\n      });\r\n    });\r\n    wx.error(function(err) {\r\n      // config信息验证失败会执行error函数，如签名过期导致验证失败，具体错误信息可以打开config的debug模式查看，也可以在返回的res参数中查看，对于SPA可以在这里更新签名。\r\n      console.log(\"wxjsapi-error=\", err);\r\n      reject(err);\r\n    });\r\n  });\r\n}\r\n\r\nexport default {handleGetLocation, handleScanQR}\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/wxJsApiSdk.js","<template>\n  <!-- begin:: Page -->\n  <div>\n    <!-- 检测定位状态 确定是否可扫码签到 -->\n    <div style=\"margin: 16px;\">\n      <van-button round block type=\"info\" \n        :loading=\"!loading\"\n        loading-text=\"加载...\"\n        @click=\"wxScanCode()\">扫码签到</van-button>\n    </div>\n    <van-cell-group>\n      <van-cell title=\"扫码结果\">\n        <template #default>\n          <span>{{ result }}</span>\n        </template>\n      </van-cell>\n    </van-cell-group>\n  </div>\n</template>\n\n<script>\n//  import wx from 'weixin-js-sdk'; //这个是坑\nimport wx from \"weixin-jsapi\"; //es6版本的js-sdk\nexport default {\n  name: \"Scan\",\n  components: {},\n  data() {\n    return {\n      loading: false,\n      config: null,\n      result: \"\" // 扫码结果\n    };\n  },\n  mounted() {\n    this.getConfig()\n  },\n  methods: {\n    getConfig() {\n      // 获取位置信息后请求后台接口\n      this.$axios({\n        method: \"post\",\n        url:\"/proxy/raptorCustomerServer/service/weChatPublicNumber/test/getTicketSignature.do\",\n        data: { url: location.href.split(\"#\")[0] } //向服务端提供授权url参数，并且不需要#后面的部分\n      })\n      .then(res => {\n        if (res) {\n          let config = res.data.data;\n          console.log(config);\n          // 存储config 同一个url仅需调用一次\n          this.config = config;\n          this.loading = true;\n        }\n      })\n      .catch(err => {\n        console.error(\"获取定位失败\", err);\n      });\n    },\n    wxScanCode() {\n      this.$handleScanQR(this.config)\n        .then(res => {\n          this.result = res.str;\n        })\n        .catch(err => {\n          console.error(\"扫描二维码失败\", err);\n        });\n    }\n  }\n};\n</script>\n<style scoped>\nh2,\n.title {\n  margin: 0;\n  text-align: left;\n  padding: 20px 16px 16px;\n  color: rgba(69, 90, 100, 0.6);\n  font-weight: normal;\n  font-size: 14px;\n  line-height: 16px;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/pages/readImg/Scanqr.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticStyle:{\"margin\":\"16px\"}},[_c('van-button',{attrs:{\"round\":\"\",\"block\":\"\",\"type\":\"info\",\"loading\":!_vm.loading,\"loading-text\":\"加载...\"},on:{\"click\":function($event){return _vm.wxScanCode()}}},[_vm._v(\"扫码签到\")])],1),_vm._v(\" \"),_c('van-cell-group',[_c('van-cell',{attrs:{\"title\":\"扫码结果\"},scopedSlots:_vm._u([{key:\"default\",fn:function(){return [_c('span',[_vm._v(_vm._s(_vm.result))])]},proxy:true}])})],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-7baf5e05\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/readImg/Scanqr.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-7baf5e05\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Scanqr.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Scanqr.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Scanqr.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-7baf5e05\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./Scanqr.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-7baf5e05\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/readImg/Scanqr.vue\n// module id = null\n// module chunks = ","import Vue from 'vue'\nimport axios from '@/axios';\nimport Vant from 'vant';\nimport 'vant/lib/index.css';\nimport vueCookies from 'vue-cookies'\n// 在main.js中引入 weixin-jsapi\nimport wx from \"weixin-jsapi\"; \nimport {handleGetLocation, handleScanQR} from '@/utils/wxJsApiSdk'\n\nimport Scanqr from './Scanqr.vue'\n\n// 在main.js中注册 weixin-jsapi\nVue.prototype.wx = wx\n\nVue.prototype.$handleGetLocation = handleGetLocation\nVue.prototype.$handleScanQR = handleScanQR\n\nVue.use(vueCookies);\nVue.use(Vant);\n\nnew Vue({\n  render: h => h(Scanqr),\n\taxios\n}).$mount('#app')\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/readImg/scanqr.js"],"sourceRoot":""}