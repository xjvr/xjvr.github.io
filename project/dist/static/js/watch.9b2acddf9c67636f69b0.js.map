{"version":3,"sources":["webpack:///./src/axios/index.js","webpack:///src/pages/watch/Watch.vue","webpack:///./src/pages/watch/Watch.vue?a1a2","webpack:///./src/pages/watch/Watch.vue","webpack:///./src/pages/watch/watch.js"],"names":["__WEBPACK_IMPORTED_MODULE_0_vue__","__webpack_require__","__WEBPACK_IMPORTED_MODULE_1_axios__","__WEBPACK_IMPORTED_MODULE_1_axios___default","n","Vue","prototype","$axios","axios","__webpack_exports__","Watch","name","components","data","showErr","latitude","longitude","err","cameraWidth","cameraHeight","mounted","navigator","mediaDevices","getUserMedia","webkitGetUserMedia","mozGetUserMedia","this","initVideo","video","height","facingMode","exact","alert","methods","getLocation","_this2","$getLocation","then","res","console","warn","lat","lng","catch","error","geolocation","getCurrentPosition","showPosition","showError","log","position","coords","code","PERMISSION_DENIED","POSITION_UNAVAILABLE","TIMEOUT","UNKNOWN_ERROR","constrains","videoSuccess","videoError","stream","$refs","_this","srcObject","play","oncanplay","videoWidth","videoHeight","readImg","message","context","canvas","getContext","timer","setInterval","drawImage","imageData","getImageData","readQrcode","readBarcode","imgBase64","quagga_min_default","a","decodeSingle","inputStream","size","locator","patchSize","halfSample","decoder","readers","format","config","locate","src","result","codeResult","clearInterval","$emit","jsQR_default","inversionAttempts","watch_Watch","render","_h","$createElement","_c","_self","_m","_v","ref","staticClass","attrs","autoplay","playsinline","webkit-playsinline","staticStyle","display","width","staticRenderFns","pages_watch_Watch","normalizeComponent","ssrContext","use","vueCookies","Vant","h","$mount"],"mappings":"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","file":"static/js/watch.9b2acddf9c67636f69b0.js","sourcesContent":["/*引入Vue框架*/\r\nimport Vue from 'vue';\r\n/*引入资源请求插件*/\r\nimport axios from 'axios';\r\n\r\n/*使用axios插件*/\r\nVue.prototype.$axios = axios;\r\nexport default({\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/axios/index.js","<template>\n  <!-- begin:: Page -->\n  <div>\n    <!-- <div style=\"margin: 16px;\">\n      <van-button round block type=\"info\" @click=\"getLocation()\"\n        >获取定位</van-button\n      >\n    </div>\n    <van-cell-group>\n      <van-cell title=\"经度\">\n        <template #default>\n          <span>{{ latitude }}</span>\n        </template>\n      </van-cell>\n      <van-cell title=\"纬度\">\n        <template #default>\n          <span>{{ longitude }}</span>\n        </template>\n      </van-cell>\n      <van-cell v-if=\"showErr\" title=\"错误\">\n        <template #default>\n          <span>{{ err }}</span>\n        </template>\n      </van-cell>\n      <div style=\"margin: 16px;\">\n        <van-button round block type=\"info\" @click=\"getLocation()\"\n          >扫码签到</van-button\n        >\n      </div>\n    </van-cell-group> -->\n    <div class=\"model\">\n      <div class=\"scanner-view\">\n        <div class=\"scanner-view-arrow arrow1\"></div>\n        <div class=\"scanner-view-arrow arrow2\"></div>\n        <div class=\"scanner-view-arrow arrow3\"></div>\n        <div class=\"scanner-view-arrow arrow4\"></div>\n        <div class=\"scanner-line\"></div>\n      </div>\n    </div>\n    <video\n      class=\"video-view\"\n      ref=\"video\"\n      autoplay\n      playsinline=\"true\"\n      webkit-playsinline=\"true\"\n    ></video>\n    <canvas\n      ref=\"canvas\"\n      width=\"478\"\n      height=\"850\"\n      style=\"display: none\"\n    ></canvas>\n  </div>\n</template>\n\n<script>\nimport jsQR from \"jsqr\";\nimport Quagga from \"quagga\";\nexport default {\n  name: \"Home\",\n  components: {},\n  data() {\n    return {\n      showErr: false,\n      latitude: \"\",\n      longitude: \"\",\n      err: \"\",\n      cameraWidth: 0,\n      cameraHeight: 0\n    };\n  },\n  // mounted() {\n  //   //  if(this.$cookies.get(\"usid\") === null) {\n  //   //    window.location.href = '/';\n  //   //  }\n  // },\n  mounted() {\n    if (navigator.mediaDevices.getUserMedia || navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia) {\n        //调用用户媒体设备，访问摄像头\n        this.initVideo({\n          video:{\n            height: 800,\n            facingMode: {\n              // 强制后置摄像头\n              exact: \"environment\"\n            }\n          }\n        });\n      } else {\n        alert(\"你的浏览器不支持访问用户媒体设备\");\n      }\n  },\n  methods: {\n    getLocation() {\n      this.$getLocation()\n        .then(res => {\n          console.warn(\"首页获取位置成功\", res);\n          this.latitude = res.lat;\n          this.longitude = res.lng;\n          // 这里根据获取到的经纬度请求后台接口...\n        })\n        .catch(err => {\n          console.error(\"首页获取位置失败\", err);\n          // 错误处理\n        });\n\n      // HTML5方法\n      if (navigator.geolocation) {\n        navigator.geolocation.getCurrentPosition(\n          this.showPosition,\n          this.showError\n        );\n      } else {\n        this.err = \"Geolocation is not supported by this browser.\";\n        console.log(\"此浏览此不支持定位\");\n        this.showErr = true;\n      }\n    },\n    showPosition(position) {\n      this.latitude = position.coords.latitude;\n      this.longitude = position.coords.longitude;\n      this.showErr = false;\n      // this.location = true;\n    },\n    showError(error) {\n      switch (error.code) {\n        case error.PERMISSION_DENIED:\n          console.log(\"User denied the request for Geolocation.\");\n          this.err = \"定位权限获取失败\";\n          break;\n        case error.POSITION_UNAVAILABLE:\n          console.log(\"Location information is unavailable.\");\n          this.err = \"定位信息获取失败\";\n          break;\n        case error.TIMEOUT:\n          console.log(\"The request to get user location timed out.\");\n          this.err = \"获取定位超时\";\n          break;\n        case error.UNKNOWN_ERROR:\n          console.log(\"An unknown error occurred.\");\n          this.err = \"发生未知错误\";\n          break;\n      }\n      this.showErr = true;\n    },\n    initVideo(constrains) {\n      let _this = this;\n      if (navigator.mediaDevices.getUserMedia) {\n        //最新标准API\n        navigator.mediaDevices\n          .getUserMedia(constrains)\n          .then(_this.videoSuccess)\n          .catch(_this.videoError);\n      } else if (navigator.webkitGetUserMedia) {\n        //webkit内核浏览器\n        navigator\n          .webkitGetUserMedia(constrains)\n          .then(_this.videoSuccess)\n          .catch(_this.videoError);\n      } else if (navigator.mozGetUserMedia) {\n        //Firefox浏览器\n        navigator\n          .mozGetUserMedia(constrains)\n          .then(_this.videoSuccess)\n          .catch(_this.videoError);\n      } else if (navigator.getUserMedia) {\n        //旧版API\n        navigator\n          .getUserMedia(constrains)\n          .then(_this.videoSuccess)\n          .catch(_this.videoError);\n      }\n    },\n    videoSuccess(stream) {\n      let video = this.$refs.video;\n      let _this = this;\n      //将视频流设置为video元素的源\n      video.srcObject = stream;\n      //播放视频\n      video.play();\n\n      video.oncanplay = function() {\n        // 摄像头分辨率,手机480x640\n        console.log(\"摄像头分辨率\");\n        console.log(video.videoWidth, video.videoHeight);\n        _this.cameraWidth = video.videoWidth;\n        _this.cameraHeight = video.videoHeight;\n        // 发送图片进行识别\n        _this.readImg();\n      };\n    },\n    videoError(error) {\n      alert(\"访问用户媒体设备失败：\", error.name, error.message)\n      console.log(\"访问用户媒体设备失败：\", error.name, error.message);\n    },\n    readImg() {\n      let video = this.$refs.video;\n      let canvas = this.$refs.canvas;\n      let context = canvas.getContext(\"2d\");\n      let _this = this;\n      let timer = setInterval(function() {\n        context.drawImage(\n          video,\n          0,\n          0,\n          _this.cameraWidth,\n          _this.cameraHeight,\n          0,\n          0,\n          478,\n          850\n        );\n        // 扫码条形码\n        // let imgUri = canvas.toDataURL();\n        // _this.readBarcode(imgUri, timer);\n        // 扫码二维码\n        let imageData = context.getImageData(0, 0, 478, 850);\n        _this.readQrcode(imageData.data, timer);\n      }, 1000);\n    },\n    readBarcode(imgBase64, timer) {\n      let _this = this;\n      Quagga.decodeSingle(\n        {\n          inputStream: {\n            size: 1920\n          },\n          locator: {\n            patchSize: \"medium\",\n            halfSample: false\n          },\n          decoder: {\n            readers: [\n              {\n                format: \"code_128_reader\",\n                config: {}\n              }\n            ]\n          },\n          locate: true,\n          src: imgBase64\n        },\n        function(result) {\n          if (result) {\n            if (result.codeResult) {\n              console.log(result.codeResult);\n              clearInterval(timer);\n              _this.$emit(\"ondata\", result.codeResult.code);\n              //              alert(\"扫码成功，结果是...\"+result.codeResult.code);\n            } else {\n              console.log(\"正在扫条形码...not detected\");\n            }\n          } else {\n            console.log(\"正在扫条形码...not detected\");\n          }\n        }\n      );\n    },\n    readQrcode(data, timer) {\n      let _this = this;\n      let code = jsQR(data, 478, 850, {\n        inversionAttempts: \"dontInvert\"\n      });\n\n      if (code) {\n        clearInterval(timer);\n        _this.$emit(\"ondata\", code.data);\n        alert('扫码成功，结果是...' + code.data);\n      } else {\n        console.log(\"正在扫二维码...\");\n      }\n    }\n  }\n};\n</script>\n<style scoped>\n  #scanner {\n    font-family: 'Avenir', Helvetica, Arial, sans-serif;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    position: relative;\n  }\n  .model{\n    box-sizing: border-box;\n    width: 100vw;\n    height: 100vh;\n    position: relative;\n    z-index: 88;\n    border-top: calc((100vh - 60vw)/2) solid rgba(0,0,0,.2);\n    border-bottom: calc((100vh - 60vw)/2) solid rgba(0,0,0,.2);\n    border-right: 20vw solid rgba(0,0,0,.2);\n    border-left: 20vw solid rgba(0,0,0,.2);\n  }\n  .scanner-view{\n    width: 100%;\n    height: 100%;\n    position: relative;\n    border: 1px solid rgba(255,255,255,.3);\n    z-index: 89;\n  }\n  .scanner-line{\n    position: absolute;\n    width: 100%;\n    height: 1px;\n    background: #49FF46;\n    border-radius: 20px;\n    z-index: 90;\n    animation: myScan 1s infinite alternate;\n  }\n  @keyframes  myScan{\n    from {\n      top: 0;\n    }\n    to {\n      top: 34vh;\n    }\n  }\n  .scanner-view-arrow{\n    position: absolute;\n    width: 5vw;\n    height: 5vw;\n    border: 2px solid #09bb07;\n  }\n  .scanner-view-arrow.arrow1{\n    top: -1px;\n    left: 0px;\n    z-index: 99;\n    border-right: none;\n    border-bottom: none;\n  }\n  .scanner-view-arrow.arrow2{\n    top: -1px;\n    right: 0px;\n    z-index: 99;\n    border-left: none;\n    border-bottom: none;\n  }\n  .scanner-view-arrow.arrow3{\n    bottom: -1px;\n    left: 0px;\n    z-index: 99;\n    border-right: none;\n    border-top: none;\n  }\n  .scanner-view-arrow.arrow4{\n    bottom: -1px;\n    right: 0px;\n    z-index: 99;\n    border-left: none;\n    border-top: none;\n  }\n  .video-view{\n    position: absolute;\n    width: 100vw;\n    height: 100vh;\n    object-fit: cover;\n    top: 0px;\n    left: 0px;\n    z-index: 80;\n  }\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/pages/watch/Watch.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_vm._m(0),_vm._v(\" \"),_c('video',{ref:\"video\",staticClass:\"video-view\",attrs:{\"autoplay\":\"\",\"playsinline\":\"true\",\"webkit-playsinline\":\"true\"}}),_vm._v(\" \"),_c('canvas',{ref:\"canvas\",staticStyle:{\"display\":\"none\"},attrs:{\"width\":\"478\",\"height\":\"850\"}})])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"model\"},[_c('div',{staticClass:\"scanner-view\"},[_c('div',{staticClass:\"scanner-view-arrow arrow1\"}),_vm._v(\" \"),_c('div',{staticClass:\"scanner-view-arrow arrow2\"}),_vm._v(\" \"),_c('div',{staticClass:\"scanner-view-arrow arrow3\"}),_vm._v(\" \"),_c('div',{staticClass:\"scanner-view-arrow arrow4\"}),_vm._v(\" \"),_c('div',{staticClass:\"scanner-line\"})])])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-6eae5a88\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/watch/Watch.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-6eae5a88\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Watch.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Watch.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Watch.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-6eae5a88\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./Watch.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-6eae5a88\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/watch/Watch.vue\n// module id = null\n// module chunks = ","import Vue from 'vue'\nimport axios from '@/axios';\nimport Vant from 'vant';\nimport 'vant/lib/index.css';\nimport vueCookies from 'vue-cookies'\nimport Watch from './Watch.vue'\n\n\nVue.use(vueCookies);\nVue.use(Vant);\n\nnew Vue({\n  render: h => h(Watch),\n\taxios\n}).$mount('#app')\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/watch/watch.js"],"sourceRoot":""}